// This is your Prisma schema file,
// learn more about it in the docs: https://pris.ly/d/prisma-schema

generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "mysql"
  url      = env("DATABASE_URL")
}

// Schemas below
model User {
  username       String   @id @unique
  email          String   @unique
  password       String
  friendCount    Int      @default(0)
  dateRegistered DateTime @default(now())
  posts          Post[] // One-to-many with Post
  reviews        Review[] // One-to-many with Review
}

model Post {
  id             Int     @id @default(autoincrement())
  title          String
  content        String
  published      Boolean @default(false)
  authorUsername String
  author         User    @relation(fields: [authorUsername], references: [username])
}

// For saving albums that have been reviewed.
// Allows us to not have to call the Spotify API again for these albums.
model Album {
  spotifyId String   @id
  name      String
  genres    Json // A list of genres (MySQL doesn't support lists, so we use JSON)
  artists   Json
  imageUrl  String
  Review    Review[]
}

model Review {
  id             Int     @id @default(autoincrement())
  albumId        String
  album          Album   @relation(fields: [albumId], references: [spotifyId])
  image          String?
  content        String
  rating         Int
  authorUsername String
  author         User    @relation(fields: [authorUsername], references: [username])
}
